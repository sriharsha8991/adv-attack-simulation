{"openapi":"3.1.0","info":{"title":"BAS Platform API","version":"0.1.0"},"paths":{"/roles":{"get":{"summary":"List Roles","operationId":"list_roles_roles_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"summary":"Create Role","operationId":"create_role_roles_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users":{"get":{"summary":"List Users","operationId":"list_users_users_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"summary":"Create User","operationId":"create_user_users_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/abilities":{"get":{"summary":"List Abilities","operationId":"list_abilities_abilities_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"summary":"Create Ability","operationId":"create_ability_abilities_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AbilityCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/abilities/{ability_id}":{"put":{"summary":"Update Ability","operationId":"update_ability_abilities__ability_id__put","parameters":[{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AbilityUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Delete Ability","operationId":"delete_ability_abilities__ability_id__delete","parameters":[{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/environments":{"get":{"summary":"List Environments","operationId":"list_environments_environments_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"summary":"Create Environment","operationId":"create_environment_environments_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EnvironmentCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/environments/{environment_id}":{"put":{"summary":"Update Environment","operationId":"update_environment_environments__environment_id__put","parameters":[{"name":"environment_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Environment Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EnvironmentUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Delete Environment","operationId":"delete_environment_environments__environment_id__delete","parameters":[{"name":"environment_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Environment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/operations":{"get":{"summary":"List Operations","operationId":"list_operations_operations_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"summary":"Create Operation","operationId":"create_operation_operations_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/operations/{operation_id}":{"get":{"summary":"Get Operation Detail","description":"Get detailed info for a single operation with execution logs.","operationId":"get_operation_detail_operations__operation_id__get","parameters":[{"name":"operation_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Operation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/operations/{operation_id}/start":{"post":{"summary":"Start Operation","operationId":"start_operation_operations__operation_id__start_post","parameters":[{"name":"operation_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Operation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/operations/{operation_id}/pause":{"post":{"summary":"Pause Operation","description":"Pause a running operation.","operationId":"pause_operation_operations__operation_id__pause_post","parameters":[{"name":"operation_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Operation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/operations/{operation_id}/resume":{"post":{"summary":"Resume Operation","description":"Resume a paused operation.","operationId":"resume_operation_operations__operation_id__resume_post","parameters":[{"name":"operation_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Operation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/operations/{operation_id}/stop":{"post":{"summary":"Stop Operation","description":"Stop an operation (kill switch).","operationId":"stop_operation_operations__operation_id__stop_post","parameters":[{"name":"operation_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Operation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/adversaries":{"get":{"summary":"List Adversaries","operationId":"list_adversaries_adversaries_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"summary":"Create Adversary","operationId":"create_adversary_adversaries_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdversaryCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/adversaries/{adversary_id}":{"put":{"summary":"Update Adversary","operationId":"update_adversary_adversaries__adversary_id__put","parameters":[{"name":"adversary_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Adversary Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdversaryUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Delete Adversary","operationId":"delete_adversary_adversaries__adversary_id__delete","parameters":[{"name":"adversary_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Adversary Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/adversaries/{adversary_id}/abilities/{ability_id}":{"post":{"summary":"Link Ability To Adversary","description":"Link an ability to an adversary","operationId":"link_ability_to_adversary_adversaries__adversary_id__abilities__ability_id__post","parameters":[{"name":"adversary_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Adversary Id"}},{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}}],"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Unlink Ability From Adversary","description":"Remove an ability link from an adversary","operationId":"unlink_ability_from_adversary_adversaries__adversary_id__abilities__ability_id__delete","parameters":[{"name":"adversary_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Adversary Id"}},{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/adversaries/{adversary_id}/abilities":{"get":{"summary":"Get Adversary Abilities","description":"Get all abilities linked to an adversary","operationId":"get_adversary_abilities_adversaries__adversary_id__abilities_get","parameters":[{"name":"adversary_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Adversary Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/abilities/{ability_id}/stages":{"post":{"summary":"Create Ability Stage","operationId":"create_ability_stage_abilities__ability_id__stages_post","parameters":[{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AbilityStageCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"summary":"Get Ability Stages","operationId":"get_ability_stages_abilities__ability_id__stages_get","parameters":[{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AbilityStageResponse"},"title":"Response Get Ability Stages Abilities  Ability Id  Stages Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/abilities/{ability_id}/stages/{stage_id}":{"put":{"summary":"Update Ability Stage","operationId":"update_ability_stage_abilities__ability_id__stages__stage_id__put","parameters":[{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}},{"name":"stage_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Stage Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AbilityStageUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Delete Ability Stage","operationId":"delete_ability_stage_abilities__ability_id__stages__stage_id__delete","parameters":[{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}},{"name":"stage_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Stage Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/payloads":{"get":{"summary":"List Payloads","operationId":"list_payloads_payloads_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"summary":"Upload Payload","operationId":"upload_payload_payloads_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_payload_payloads_post"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/payloads/{payload_id}/download":{"get":{"summary":"Download Payload","description":"Download payload file as base64 for agent execution","operationId":"download_payload_payloads__payload_id__download_get","parameters":[{"name":"payload_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Payload Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/login":{"post":{"summary":"Login","operationId":"login_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/agent/task":{"get":{"summary":"Get Agent Task","description":"Agent calls this to get next task to execute.\nFinds a running operation -> adversary -> abilities -> stages -> payloads\nReturns the first stage that hasn't been executed yet.","operationId":"get_agent_task_agent_task_get","parameters":[{"name":"agent_id","in":"query","required":true,"schema":{"type":"string","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/agent/result":{"post":{"summary":"Submit Agent Result","description":"Agent submits execution result here.\nCreates an execution_log entry.","operationId":"submit_agent_result_agent_result_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentResultRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/agent/register":{"post":{"summary":"Register Agent","description":"Agent registers itself. Returns agent_id for future requests.","operationId":"register_agent_agent_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentRegisterRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/agents":{"get":{"summary":"List Agents","description":"List all registered agents with computed status.","operationId":"list_agents_agents_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/AgentResponse"},"type":"array","title":"Response List Agents Agents Get"}}}}}}},"/agents/{agent_id}/toggle":{"put":{"summary":"Toggle Agent","description":"Enable or disable an agent connection.","operationId":"toggle_agent_agents__agent_id__toggle_put","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/agents/{agent_id}":{"delete":{"summary":"Delete Agent","operationId":"delete_agent_agents__agent_id__delete","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/agent/heartbeat":{"post":{"summary":"Agent Heartbeat","operationId":"agent_heartbeat_agent_heartbeat_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentHeartbeatRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/abilities/{ability_id}/stages/reorder":{"post":{"summary":"Reorder Ability Stages","operationId":"reorder_ability_stages_abilities__ability_id__stages_reorder_post","parameters":[{"name":"ability_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ability Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StageReorderRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AbilityCreate":{"properties":{"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"mitre_tactic":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mitre Tactic"},"mitre_technique_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mitre Technique Id"},"platform":{"type":"string","title":"Platform"},"impact_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Impact Type"},"default_severity":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Default Severity"},"requires_approval":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Requires Approval","default":false},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"}},"type":"object","required":["name","platform"],"title":"AbilityCreate"},"AbilityStageCreate":{"properties":{"stage_name":{"type":"string","title":"Stage Name"},"stage_order":{"type":"integer","title":"Stage Order"},"executor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Executor"},"command_template":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Command Template"},"timeout_seconds":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Timeout Seconds"},"payload_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Payload Id"}},"type":"object","required":["stage_name","stage_order"],"title":"AbilityStageCreate"},"AbilityStageResponse":{"properties":{"stage_id":{"type":"string","format":"uuid","title":"Stage Id"},"ability_id":{"type":"string","format":"uuid","title":"Ability Id"},"stage_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stage Name"},"stage_order":{"type":"integer","title":"Stage Order"},"executor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Executor"},"command_template":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Command Template"},"timeout_seconds":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Timeout Seconds"},"payload_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Payload Id"}},"type":"object","required":["stage_id","ability_id","stage_order"],"title":"AbilityStageResponse"},"AbilityStageUpdate":{"properties":{"stage_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stage Name"},"stage_order":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Stage Order"},"executor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Executor"},"command_template":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Command Template"},"timeout_seconds":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Timeout Seconds"},"payload_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Payload Id"}},"type":"object","title":"AbilityStageUpdate"},"AbilityUpdate":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"mitre_tactic":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mitre Tactic"},"mitre_technique_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mitre Technique Id"},"platform":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Platform"},"impact_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Impact Type"},"default_severity":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Default Severity"},"requires_approval":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Requires Approval"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"}},"type":"object","title":"AbilityUpdate"},"AdversaryCreate":{"properties":{"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"profile":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Profile"},"execution_strategy":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Execution Strategy"}},"type":"object","required":["name"],"title":"AdversaryCreate"},"AdversaryUpdate":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"profile":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Profile"},"execution_strategy":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Execution Strategy"}},"type":"object","title":"AdversaryUpdate"},"AgentHeartbeatRequest":{"properties":{"agent_id":{"type":"string","title":"Agent Id"},"passkey":{"type":"string","title":"Passkey"}},"type":"object","required":["agent_id","passkey"],"title":"AgentHeartbeatRequest"},"AgentRegisterRequest":{"properties":{"passkey":{"type":"string","title":"Passkey"},"agent_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Agent Id"},"hostname":{"type":"string","title":"Hostname"},"ip_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ip Address"},"platform":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Platform","default":"windows"}},"type":"object","required":["passkey","hostname"],"title":"AgentRegisterRequest"},"AgentResponse":{"properties":{"agent_id":{"type":"string","title":"Agent Id"},"hostname":{"type":"string","title":"Hostname"},"ip_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ip Address"},"platform":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Platform"},"is_enabled":{"type":"boolean","title":"Is Enabled"},"last_seen":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Seen"},"registered_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Registered At"},"display_status":{"type":"string","title":"Display Status"}},"type":"object","required":["agent_id","hostname","ip_address","platform","is_enabled","last_seen","registered_at","display_status"],"title":"AgentResponse"},"AgentResultRequest":{"properties":{"operation_id":{"type":"string","format":"uuid","title":"Operation Id"},"ability_id":{"type":"string","format":"uuid","title":"Ability Id"},"stage_id":{"type":"string","format":"uuid","title":"Stage Id"},"command_executed":{"type":"string","title":"Command Executed"},"stdout":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stdout"},"stderr":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stderr"},"exit_code":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Exit Code"}},"type":"object","required":["operation_id","ability_id","stage_id","command_executed"],"title":"AgentResultRequest"},"Body_upload_payload_payloads_post":{"properties":{"name":{"type":"string","title":"Name"},"platform":{"type":"string","title":"Platform"},"type":{"type":"string","title":"Type"},"risk_classification":{"type":"string","title":"Risk Classification"},"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["name","platform","type","risk_classification","file"],"title":"Body_upload_payload_payloads_post"},"EnvironmentCreate":{"properties":{"name":{"type":"string","title":"Name"},"environment_type":{"type":"string","title":"Environment Type"},"risk_tolerance":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Risk Tolerance"},"network_ranges":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Network Ranges"},"allowed_tactics":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Allowed Tactics"},"blocked_techniques":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Blocked Techniques"}},"type":"object","required":["name","environment_type"],"title":"EnvironmentCreate"},"EnvironmentUpdate":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"environment_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Environment Type"},"risk_tolerance":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Risk Tolerance"},"network_ranges":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Network Ranges"},"allowed_tactics":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Allowed Tactics"},"blocked_techniques":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Blocked Techniques"}},"type":"object","title":"EnvironmentUpdate"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginRequest":{"properties":{"email":{"type":"string","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"LoginRequest"},"OperationCreate":{"properties":{"name":{"type":"string","title":"Name"},"adversary_id":{"type":"string","format":"uuid","title":"Adversary Id"},"environment_id":{"type":"string","format":"uuid","title":"Environment Id"},"execution_mode":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Execution Mode"}},"type":"object","required":["name","adversary_id","environment_id"],"title":"OperationCreate"},"RoleCreate":{"properties":{"name":{"type":"string","title":"Name"},"permissions":{"additionalProperties":true,"type":"object","title":"Permissions"}},"type":"object","required":["name","permissions"],"title":"RoleCreate"},"StageReorderRequest":{"properties":{"stage_ids":{"items":{"type":"string","format":"uuid"},"type":"array","title":"Stage Ids"}},"type":"object","required":["stage_ids"],"title":"StageReorderRequest"},"UserCreate":{"properties":{"name":{"type":"string","title":"Name"},"email":{"type":"string","format":"email","title":"Email"},"role_id":{"type":"string","format":"uuid","title":"Role Id"},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}},"type":"object","required":["name","email","role_id"],"title":"UserCreate"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"},"input":{"title":"Input"},"ctx":{"type":"object","title":"Context"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}